# Airflow Study QA Log - 2026-01-27

이 파일은 2026-01-27 학습 세션의 질문과 답변을 기록합니다.

## [2026-01-27] Airflow UI/UX 핵심 모니터링 및 관리 가이드

**질문**: 첫 번째 DAG를 실행했는데, Airflow UI에서 무엇을 중요하게 보고 관리해야 하나요?

**답변**: 축하드립니다! 첫 DAG 실행은 데이터 엔지니어링 여정의 큰 첫걸음입니다. Airflow UI는 단순한 '대시보드'가 아니라 **"데이터 파이프라인의 관제탑"**입니다. 시니어의 시선에서 꼭 알아야 할 4가지 화면을 짚어 드릴게요.

---

### 1. Grid View (전체적인 흐름과 이력 확인)
- **목적**: "최근에 실행된 DAG들이 잘 돌았나?"를 한눈에 보는 곳입니다.
- **보는 법**: 
  - 세로줄 하나가 **'한 번의 실행(DAG Run)'**을 의미합니다.
  - 초록색 네모는 성공, 빨간색은 실패입니다.
  - 특정 네모를 클릭하면 그 시간에 정확히 무슨 일이 있었는지 세부 정보가 오른쪽에 뜹니다.

### 2. Graph View (설계도와 현재 상태 확인)
- **목적**: "작업(Task)들이 어떤 순서로 연결되어 있고, 지금 어디서 돌고 있나?"를 확인합니다.
- **활용**: 
  - `assignment_01`처럼 `extract >> transform >> load` 순서가 시각적으로 보입니다.
  - 테두리 색깔을 보세요. **진한 초록색**은 성공, **연한 초록색**은 현재 실행 중, **빨간색**은 실패입니다.

### 3. Log (디버깅의 심장)
- **가장 중요**: 에러가 났을 때 가장 먼저 달려가야 할 곳입니다.
- **보는 법**: 
  1. Graph나 Grid에서 특정 Task(예: `extract_raw_data`)를 클릭합니다.
  2. 상단 탭에서 **'Logs'**를 누릅니다.
  3. 코드에 썼던 `print("원천 데이터를 생성합니다...")` 같은 메시지가 시간대별로 찍혀 있는 것을 볼 수 있습니다.

### 4. Task Instance Operations (문제 해결 도구)
Task를 클릭했을 때 나오는 버튼 중 실무에서 가장 많이 쓰는 2가지입니다.
- **Clear**: "이 단계부터 다시 실행해!" (코드를 고친 뒤 실패한 지점부터 다시 돌릴 때 씁니다.)
- **Mark Failed/Success**: "이건 실행 안 됐지만 성공한 걸로 치자" 혹은 그 반대일 때 씁니다.

---

### 💡 시니어의 UI UX 팁
1. **Auto-refresh**: UI 상단 오른쪽의 `Auto-refresh` 스위치를 켜두세요. 페이지를 새로고침하지 않아도 작업 상태가 변하는 것을 실시간으로 볼 수 있습니다.
2. **XComs 탭**: Task 클릭 후 `XComs` 탭을 보세요. `return`한 데이터가 Airflow 메모리에 어떻게 임시로 저장되어 있는지 확인할 수 있습니다.

이 4가지만 익숙해져도 Airflow 운영의 80%는 마스터하신 겁니다!

> [!NOTE]
> 한국어 UI를 사용 중이시므로, 위 지표들이 **'그리드'**, **'그래프'**, **'로그'** 등으로 번역되어 있을 것입니다. 메뉴 위치는 동일하니 아이콘과 위치를 참고해 주세요!

---

## [2026-01-27] Airflow의 전령, XCom (Cross-Communication) 이해하기

**질문**: XCom이 정확히 무엇이고 어떻게 쓰나요?

**답변**: XCom은 **"Cross-Communication"**의 약자로, 쉽게 말해 **"Task끼리 데이터를 주고받는 쪽지"**라고 생각하시면 됩니다.

### 1. 왜 필요한가요?
Airflow의 각 Task(일꾼)들은 서로 완전히 독립된 공간에서 일합니다. `extract_task`가 만든 데이터를 `transform_task`가 쓰려면, 누군가 그 데이터를 전달해 줘야 하는데 그 역할을 XCom이 합니다.

### 2. 어떻게 작동하나요?
- **내보내기 (Push)**: 파이썬 함수에서 `return`을 하면 Airflow가 자동으로 그 값을 XCom에 저장합니다.
- **가져오기 (Pull)**: 다른 Task에서 `context`나 `xcom_pull` 기능을 통해 그 값을 꺼내 옵니다.

### 3. 한국어 UI에서의 확인
- 특정 **작업(Task)** 인스턴스를 클릭하면 나오는 메뉴 중에 **'XCom'**이라는 항목이 있을 것입니다.
- 거기 들어가 보면 `return_value`라는 이름으로 아까 함수가 `return` 했던 데이터가 찍혀 있는 것을 볼 수 있습니다.

### ⚠️ 주의사항 (시니어의 조언)
XCom은 **"비싼 유료 배달"**과 같습니다. 
- **용량 제한**: 너무 큰 데이터(수만 줄의 엑셀 파일 등)를 XCom으로 주고받으면 Airflow 데이터베이스가 느려지거나 터질 수 있습니다.
- **용도**: 주로 데이터의 경로(S3 주소), 처리된 행의 개수, 상태값 등 **가벼운 정보**를 전달할 때만 사용하는 것이 정석입니다.

---

## [2026-01-27] 왜 extract_raw_data에만 XCom 값이 보이나요? (Push vs Pull)

**질문**: UI를 보니 `extract_raw_data`에만 XCom 값이 있고 다른 곳은 없어요. 데이터를 넘겨줬다는 뜻인가요?

**답변**: 네, 정확한 통찰입니다! 그 이유는 코드 안의 **`return`** 키워드에 있습니다.

### 1. "자동 배달"의 조건: `return`
- `assignment_01_basic_dag.py` 코드를 보시면, `create_raw_data` 함수 마지막에만 **`return data`**가 적혀 있습니다.
- `PythonOperator`는 함수가 무언가를 `return` 하면, **"아, 이건 다음 사람에게 줄 쪽지구나!"**라고 판단해서 자동으로 XCom 상자에 넣습니다.
- 나머지 `aggregate_data`와 `print_final_result`는 `return` 문이 없어서(즉, 반환값이 `None`이라서) XCom에 저장할 내용이 없었던 것입니다.

### 2. "전달"과 "수령"은 다릅니다!
- 지금 상태는 **'배달 완료(Push)'**만 된 상태이지, 다음 사람이 **'수령(Pull)'**한 상태는 아닙니다.
- `extract_task`가 XCom에 데이터를 던져두긴 했지만, 뒤에 있는 `transform_task`가 그 쪽지를 꺼내서 쓰는 코드는 아직 짜지 않았기 때문입니다.

### 3. 어떻게 꺼내 쓰나요?
나중에 배우겠지만, 다음 Task에서 `xcom_pull`이라는 명령어를 써야 비로소 상자에서 쪽지를 꺼내 실제 데이터로 활용하게 됩니다.

**요약**: 
- `return`이 있는 Task만 XCom을 생성합니다. 
- 지금은 데이터를 **던져만 놓은 상태**이며, 실제로 받아 쓰는 법은 다음 단계에서 배우게 됩니다!

---

## [2026-01-27] VS Code 작업 폴더와 가상환경(venv) 인식 팁

**질문**: VS Code 시작 폴더를 `vscode/airflow`로 해야 가상환경을 잘 잡지 않을까요?

**답변**: 네, 맞습니다! 역시 환경 설정에 대해서도 핵심을 꿰뚫고 계시네요.

### 1. VS Code의 venv 탐색 원리
VS Code는 기본적으로 **"내가 현재 열고 있는 폴더(Workspace Root)"**와 그 하위 폴더에서 가상환경(`.venv`, `venv` 등)을 찾습니다. 
- 만약 `airflow/airflow` 폴더만 열었다면, 상위에 있는 `venv`를 자동으로 못 찾을 수 있습니다.
- 따라서 말씀하신 대로 한 단계 위인 `c:\vscode\airflow`를 루트로 여는 것이 가상환경 인식에 훨씬 유리합니다.

### 2. 현재 폴더 구조의 특이점
확인해 보니 상위 폴더에도 `dags/`가 있고, 하위 `airflow/` 안에도 `dags/`가 있는 구조입니다.
- **추천**: `c:\vscode\airflow`를 워크스페이스로 여시되, 우리가 현재 진행 중인 과제들은 `airflow/dags/` 안에 있다는 점만 기억해 주세요!
- 가상환경이 한 번 잡히면 파이썬 코드 작성 시 라이브러리 자동 완성(IntelliSense)이 훨씬 잘 작동할 것입니다.

### 3. 직접 Push 해보기
이제 제가 만든 코드들이 다 저장되었습니다. 직접 `git push`를 해보시면서 서버 반영 프로세스를 손에 익혀보시기 바랍니다! (충돌 발생 시 언제든 말씀해 주세요.)

---

## [2026-01-27] PowerShell vs CMD: 무엇이 다르고 어떻게 쓰나요?

**질문**: 가상환경을 잡으려고 하는데, 파워쉘(PowerShell)과 CMD의 차이는 무엇인가요?

**답변**: 윈도우에서 개발할 때 가장 먼저 마주하는 고민이죠! 핵심만 딱 짚어 드릴게요.

### 1. 한 줄 요약
- **CMD (Command Prompt)**: **"클래식카"**. 80년대 DOS 시절부터 내려온 유물입니다. 단순하고 가볍지만, 복잡한 명령을 내리기엔 한계가 있습니다.
- **PowerShell**: **"최신 슈퍼카"**. 마이크로소프트가 개발자를 위해 만든 강력한 도구입니다. 윈도우의 모든 것을 제어할 수 있고, 파이썬처럼 객체 지향적인 특성이 있습니다.

### 2. 가상환경 활성화 방식의 차이
가상환경(`venv`) 폴더가 `c:\vscode\airflow\venv`에 있다고 가정할 때, 실행하는 파일이 다릅니다.

- **CMD**: 
  ```cmd
  venv\Scripts\activate.bat
  ```
- **PowerShell**:
  ```powershell
  .\venv\Scripts\Activate.ps1
  ```

### 3. 왜 PowerShell에서 에러가 나나요? (보안 정책)
처음 PowerShell을 쓰면 "스크립트를 실행할 수 없습니다"라는 빨간 에러가 자주 뜹니다. 이는 보안을 위해 외부 파일 실행을 막아뒀기 때문인데, 아래 명령어로 한 번만 풀어주면 됩니다.
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

### 💡 시니어의 선택은?
요즘은 **PowerShell**이 대세입니다. VS Code의 기본 터미널도 PowerShell로 되어 있죠. 하지만 단순히 `git` 명령어나 파이썬 실행만 한다면 **CMD**가 훨씬 직관적이고 오류가 적을 때가 많습니다.

**초보 단계 추천**: 
처음에는 에러가 적은 **CMD**로 가상환경을 활성화해 보시고, 익숙해지면 강력한 **PowerShell**로 넘어가시는 것을 추천드려요!

---

## [2026-01-27] Git의 핵심: 커밋(Commit)과 푸쉬(Push) 마스터하기

**질문**: 커밋(Commit)이 정확히 무슨 뜻인가요? 그리고 명령어를 알려주세요.

**답변**: Git을 사용할 때 가장 많이 쓰는 단어들이죠! 아주 쉽게 설명해 드릴게요.

### 1. 커밋(Commit)이란?
- **의미**: **"게임의 저장 지점(Save Point)"**과 같습니다.
- 지금까지 작업한 파일들의 상태를 스냅샷 찍듯이 찰칵! 기록하고, 거기에 **"이름(메시지)"**을 붙여두는 행위입니다. 
- 나중에 작업이 꼬였을 때, 특정 일시나 특정 메시지가 있는 커밋으로 언제든 되돌아갈 수 있습니다.

### 2. 세트로 외우는 3단계 명령어
Git 보관소에 저장하고 서버로 보내는 과정은 늘 이 3단계를 거칩니다.

1. **`git add .`** (상자에 담기)
   - "수정된 가방들 중에 어떤 걸 저장할지 골라줘"라는 뜻입니다. `.`은 "수정된 모든 파일을 다 담겠다"는 뜻입니다.
2. **`git commit -m "오늘의 작업 내용"`** (테이프 붙이고 이름 쓰기)
   - 상자를 닫고 테이프를 붙인 뒤, 겉면에 어떤 작업인지 메모를 적는 단계입니다.
3. **`git push`** (트럭에 실어 서버로 보내기)
   - 내 컴퓨터에 저장된 이 상자를 **GitHub(구름 위 저장소)**로 슝~ 보내는 단계입니다.

### 💡 실전 연습
지금 바로 터미널에서 아래 순서대로 입력해 보세요:
```bash
git add .
git commit -m "Assignment 02 DAG 작성 및 학습 기록 업데이트"
git push
```

이제 GitHub 사이트에 들어가 보시면, 방금 보낸 메시지와 함께 파일들이 최신으로 바뀐 것을 확인하실 수 있습니다!

---

## [2026-01-27] 연결된 파이프라인: xcom_pull로 데이터 받아오기

**질문**: 앞선 작업의 결과물을 어떻게 실제로 가져와서 계산에 쓰나요?

**답변**: 드디어 데이터 파이프라인의 핵심인 **'수령(Pull)'** 단계에 오셨습니다! 

### 1. 전제 조건: `**context`
파이썬 함수를 정의할 때 인자에 `**context`를 넣어주면, Airflow가 실행 시점에 해당 작업의 정보(Task Instance 등)를 함수에 통째로 넘겨줍니다.

### 2. 핵심 명령어: `ti.xcom_pull`
함수 내부에서 다음과 같이 사용합니다.
```python
def my_function(**context):
    ti = context['ti']  # 상자(Task Instance)를 꺼냅니다.
    data = ti.xcom_pull(task_ids='이전_작업_ID') # 특정 ID의 작업이 남긴 쪽지를 꺼냅니다.
```

### 3. 왜 이게 강력한가요?
이제 `extract` 단계에서 뽑아온 데이터가 수천 개든 수만 개든, `transform` 단계에서 그대로 받아와서 파이썬의 강력한 라이브러리(Pandas 등)를 활용해 주무를 수 있게 됩니다.

**주의**: `xcom_pull`을 쓸 때는 **`task_ids`**를 정확히 적어주어야 합니다. 쪽지함에서 엉뚱한 사람의 쪽지를 꺼내면 안 되니까요!
